{
  "ConnectionStrings": {
    "DefaultConnection": "Host=localhost;Port=5432;Database=currency_tracking_db;Username=currency_tracking_user;Password=admin;"
  },
  "Jwt": {
    "SecretKey": "this-is-a-very-long-and-secure-key-with-32-chars",
    "Issuer": "CurrencyTracker",
    "Audience": "CurrencyTracker",
    "ExpiryMinutes": 60
  },
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  },
  //"ReverseProxy": {
  //  "Routes": {
  //    "user-service": {
  //      "ClusterId": "user-service",
  //      "Match": {
  //        "Path": "/api/user/{**catch-all}"
  //      }
  //    },
  //    "finance-swagger": {
  //      "ClusterId": "finance-cluster",
  //      "Match": {
  //        "Path": "/finance-service/swagger/{**catch-all}"
  //      },
  //      "Transforms": [
  //        { "PathRemovePrefix": "/finance-service" }
  //      ]
  //      //"AuthorizationPolicy": "requireJwtToken"
  //    },
  //    "finance-api": {
  //      "ClusterId": "finance-cluster",
  //      "Match": {
  //        "Path": "/finance-api/{**catch-all}"
  //      },
  //      "Transforms": [
  //        { "PathRemovePrefix": "/finance-api" }
  //      ]
  //    }
  //  },
  //  "Clusters": {
  //    "user-service": {
  //      "Destinations": {
  //        "destination1": {
  //          "Address": "https://localhost:6001/"
  //        }
  //      }
  //    },
  //    "finance-cluster": {
  //      "Destinations": {
  //        "finance-service": {
  //          "Address": "http://finance-service/"
  //        }
  //      }
  //    }
  //  }
  //},
  "ReverseProxy": {
    "Routes": {
      "user-register": {
        "ClusterId": "user-service",
        "Match": {
          "Path": "/api/users/register",
          "Methods": [ "POST" ]
        }
      },
      "user-login": {
        "ClusterId": "user-service",
        "Match": {
          "Path": "/api/users/login",
          "Methods": [ "POST" ]
        }
      },
      "user-logout": {
        "ClusterId": "user-service",
        "Match": {
          "Path": "/api/users/logout",
          "Methods": [ "POST" ]
        },
        "Transforms": [
          {
            "RequestHeader": "X-User-Id",
            "Set": "{User:FindFirstValue(ClaimTypes.NameIdentifier)}"
          }
        ]
        //"AuthorizationPolicy": "requireJwtToken"
      },
      //"secured-route": {
      //  "ClusterId": "user-service",
      //  "Match": {
      //    "Path": "/users/{**catch-all}",
      //    "Methods": [ "GET", "POST", "PUT", "DELETE" ]
      //  },
      //  // Оставьте авторизацию только для защищенных маршрутов
      //  "AuthorizationPolicy": "requireJwtToken",
      //  "Transforms": [
      //    { "PathRemovePrefix": "/users" }
      //  ]
      //},
      "finance-favorites": {
        "ClusterId": "finance-service",
        "Match": {
          "Path": "/api/currencies/favorites",
          "Methods": [ "PUT" ]
        },
        //"AuthorizationPolicy": "authenticated",
        //"AuthorizationPolicy": "requireJwtToken",
        "Transforms": [
          {
            "PathRemovePrefix": "/currencies"
          },
          {
            "RequestHeader": "X-User-Id",
            "Set": "{User:FindFirstValue(ClaimTypes.NameIdentifier)}"
          }
        ]
      },
      "finance-favorites-get": {
        "ClusterId": "finance-service",
        "Match": {
          "Path": "/api/currencies/favorites",
          "Methods": [ "GET" ]
        },
        //"AuthorizationPolicy": "authenticated",
        //"AuthorizationPolicy": "requireJwtToken",
        "Transforms": [
          //{
          //  "PathRemovePrefix": "/currencies"
          //},
          {
            "RequestHeader": "X-User-Id",
            "Set": "{User:FindFirstValue(ClaimTypes.NameIdentifier)}"
          }
        ]
      }
    },
    "Clusters": {
      "user-service": {
        "Destinations": {
          "user-service": {
            "Address": "http://localhost:6001/"
          }
        }
      },
      "finance-service": {
        "Destinations": {
          "finance-service": {
            "Address": "http://localhost:6002/"
          }
        }
      }
    }
  },
  "AllowedHosts": "*"
}
